\section{简介}
\label{sec:featurespy-intro}

云提供商可以通过 {\em deduplication} \cite{harnik10} 消除重复内容的传输/存储来降低维护成本。具体来说，客户端（例如，企业或个人）首先将某些数据的加密哈希（称为 {\em 指纹}）发送到云端，云端通过指纹检查数据是否已存储。如果云端已经有数据的副本（例如，其他客户端上传的），客户端不需要再次上传数据，从而节省带宽和存储空间（称为{\em source-based deduplication}） .现场研究表明，重复数据删除在实际工作负载 \cite{jin09, meyer11, wallace12} 中实现了大量节省，并且节省的成本可以直接回馈给客户 \cite{bellare13b, armknecht15}。


{\em Encrypted deduplication} 通过加密保护 \cite{bellare2013MLE, halevi11} 增强了重复数据删除，从而保护外包数据免受受损云和恶意客户端的侵害。具体来说，为了防止受感染的云窃听信息，它在客户端执行 {\em 消息锁定加密 (MLE)} \cite{bellare2013MLE}，将重复的原始数据（来自相同或不同的客户端）映射为重复的加密通过从要加密的内容派生的对称密钥（称为 {\em MLE key}）获取数据。例如，MLE 密钥可以是目标数据 \cite{douceur02} 的加密哈希，这样重复数据删除对加密数据仍然有效。

此外，源端重复数据删除中的恶意客户端可以发送任何目标加密数据的指纹（其内容尚未授权访问），以说服它是目标数据的所有者，从而获得授权的数据访问 \cite{ halevi11,mulazzani11}。为了防止恶意客户端说服虚假所有权，加密后重复数据删除将源端重复数据删除与 {\em 所有权证明 (PoW)} \cite{halevi11} 相结合，并强制每个客户端（另外）向云证明它确实是目标加密数据的所有者（即，可以完全访问内容）并被授权对其执行重复数据删除。
然而，加密后重复数据删除，尤其是 PoW 不足以完全击败恶意客户端，恶意客户端枚举数据内容以发起 {\em learning-content 攻击} \cite{harnik10, zuo2018mitigating}。具体来说，攻击者先验地知道数据文件的大部分内容（例如，报价模板），并旨在识别其他客户拥有的文件的私有部分（例如，报价中的实际工资和奖金） .它通过枚举私有内容的可能值来伪造许多文件，对每个伪造文件执行源端重复数据删除，并在不需要上传某些文件时推断出私有信息。我们扩展了以前的研究 \cite{harnik10, zuo2018mitigating} 以证明实践中学习内容攻击的严重性。具体来说，通过一个案例研究，我们表明它可以在本地网络环境中不超过两分钟的时间内推断出低熵（例如，数千个枚举）的私有内容，而在真实的云环境中则为八分钟。我们认为 PoW 无法阻止学习内容攻击，因为对手可以访问全部内容并且能够说服其对这些文件的所有权。


本文介绍了 \sysnameF，它通过主动检测每个客户端中的学习内容攻击来增强加密后重复数据删除。 \sysnameF 建立在恶意客户端（发起学习内容攻击）对许多枚举的 {\em 相似} 内容执行源端重复数据删除的洞察之上，其中信息更改仅限于少数数据区域。另一方面，我们的研究表明，实际未篡改工作负载中的连续内容（可能一起处理）彼此之间存在显着差异。因此，\sysnameF 检查客户端 {\em 可信执行环境 (TEE)} \cite{sgx} 中处理内容的相似性，这允许诚实地针对恶意客户端运行检测过程。如果在短时间内处理了许多类似的数据，它就会报告攻击。


但是，恶意客户端可能会篡改流程工作流以绕过 TEE 中的检测程序。具体来说，它可以提交自己构建的数据来执行源端重复数据删除，从而发起学习内容攻击。

\sysnameF 建立在最近基于 TEE 的 PoW 方法 \cite{ren21} 的基础上，它确保只能对 TEE 处理的加密内容执行重复数据删除。它基于加密数据检测相似性，并将检测过程与 TEE 中的 PoW 耦合，以防止恶意客户端绕过检测过程。具体来说，\sysnameF 提出了 {\em 相似性保留加密 (SPE)}，它扩展了具有相似性保留的 MLE。除了 MLE 密钥，SPE 还根据原始数据的内容特征推导出一个 {\em 特征密钥}，这样相似的原始数据很可能具有相同的特征密钥。它使用特征密钥加密一小部分原始内容以保持相似性，而剩余的大部分仍受 MLE 密钥保护以确保安全。由于相似数据仅在少数区域不同，\sysnameF 通过比较加密的小部分来检测相似的原始数据。


我们广泛表明 \sysnameF 可以有效地检测学习内容攻击（例如，在我们的案例研究中，概率至少为 98.6\%），而误判的数量很低（例如，\sysnameF 的默认配置中为零）。此外，我们将 \sysnameF 部署到现有的面向性能的系统 SGXDedup \cite{ren21} 中，以提高其对学习内容攻击的安全性。请注意，SGXDedup 基于 TEE 构建，可将之前的加密后重复数据删除系统 \cite{bellare13b} 加速八倍以上，而我们的 \sysnameF 部署系统，即 \prototype 相比 SGXDedup 的性能开销低至 8.8\% 和 0.8\%分别是大规模真实世界数据的上传和下载。
在最后的论文中，我们将发布 \prototype 的源代码以供公众验证。