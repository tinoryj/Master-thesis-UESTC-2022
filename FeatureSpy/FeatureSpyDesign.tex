\section{FeatureSpy设计}
\label{sec:featurespy-design}

本文在设计\sysnameF 时考虑了以下设计目标：

\begin{itemize}[leftmargin=0em]
    \item \textbf{攻击检测。}\sysnameF 需可靠地检测推测内容攻击以防止客户端篡改(即具有强鲁棒性)。此外，需要实现较高的攻击检测成功率并维持较低的误判率。
    \item \textbf{保密性和带宽/存储效率。}\sysnameF 需要兼容源端重复数据删除，以达到高数据保密性和高带宽/存储效率的双重目标。此外，\sysnameF 还需减轻由于密钥泄露导致的数据块信息泄露。
    \item \textbf{低性能开销。}\sysnameF 需在上传时在线检测推测内容攻击是否发生，并在实际部署中仅产生可控且较低的性能开销。
    \item \textbf{最小化可信计算基(TCB)。}由于滥用安全区产生巨大可信计算基具有较高安全风险\cite{lie2005TCB}，\sysnameF 需尽可能减小安全区大小。
\end{itemize}

本文首先提出一个安全性不足但直接的基于明文的攻击检测方案来演示本文如何通过监控数据块处理来检测推测内容攻击。然后，本文提出\sysnameF，它可以防止恶意客户端绕过推测内容攻击的检测程序。

\input{FeatureSpy/FeatureSpyDesign-basic}
\input{FeatureSpy/FeatureSpyDesign-secure}
\input{FeatureSpy/FeatureSpyDesign-SPE}
\input{FeatureSpy/FeatureSpyDesign-security}